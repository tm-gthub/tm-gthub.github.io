<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flappy Fascinus</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #1a0a2e; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; font-family: 'Courier New', monospace; overflow: hidden; }
  canvas { border: 3px solid #c8a951; image-rendering: pixelated; cursor: pointer; }
  #ui { color: #f0d080; text-align: center; margin-bottom: 10px; font-size: 13px; letter-spacing: 1px; }
  #title { font-size: 22px; color: #ffd700; text-shadow: 0 0 15px rgba(255,215,0,0.6); margin-bottom: 4px; }
  #sub { color: #aaa; font-size: 11px; }
</style>
</head>
<body>
<div id="ui">
  <div id="title">⚡ FLAPPY FASCINUS ⚡</div>
  <div id="sub">CLICK / SPACE to flap • Avoid the Fausters</div>
</div>
<canvas id="c" width="400" height="550"></canvas>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
ctx.imageSmoothingEnabled = false;

const W = 400, H = 550;
const PIPE_W = 90;
const GAP = 160;
const PIPE_SPEED = 2.5;
const GRAVITY = 0.38;
const FLAP = -7.5;
const PIPE_INTERVAL = 110;

// ── STATE ──
let bird, pipes, score, hiScore, frame, gameState, particles;
// gameState: 'start' | 'playing' | 'dead'

function init() {
  bird = { x: 90, y: H / 2, vy: 0, rotation: 0, flapping: false, flapFrame: 0 };
  pipes = [];
  score = 0;
  frame = 0;
  gameState = 'start';
  particles = [];
  hiScore = hiScore || 0;
}
init();

// ── PIXEL ART DRAWINGS ──

// Draw pixelated fascinus (ancient Roman winged phallus amulet)
// Drawn as cute pixel art — shaft, glans, wings, tail, legs, bells
function drawFascinus(x, y, rot) {
  ctx.save();
  ctx.translate(x, y);
  ctx.rotate(rot);

  const S = 3; // pixel size

  // Wing flap animation
  const wingUp = Math.sin(frame * 0.25) > 0;

  // Body / shaft (pinkish beige)
  const body = [
    [0,0],[1,0],[2,0],[3,0],
    [0,1],[1,1],[2,1],[3,1],
    [0,2],[1,2],[2,2],[3,2],
    [-1,1],[-1,2],
  ];
  ctx.fillStyle = '#d4956a';
  body.forEach(([px,py]) => ctx.fillRect((px-1)*S, (py-3)*S, S, S));

  // Glans (tip - rounded, darker)
  ctx.fillStyle = '#b06040';
  [[0,-1],[1,-1],[2,-1],[0,-2],[1,-2]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
  ctx.fillStyle = '#c07050';
  [[0,-3],[1,-3]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));

  // Base / frenulum line
  ctx.fillStyle = '#a05030';
  [[0,3],[1,3],[2,3],[3,3]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));

  // Scrotum (two circles at base)
  ctx.fillStyle = '#c08060';
  [[-2,1],[-2,2],[-1,0],[-3,0],[-3,1],[-3,2],[-4,1]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
  ctx.fillStyle = '#a06040';
  [[-2,3],[-3,3],[-1,3],[-4,2]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));

  // Wings (golden, spread)
  ctx.fillStyle = '#f0c030';
  if (wingUp) {
    // Up position
    [[-1,-4],[0,-5],[1,-6],[2,-5],[3,-4],[4,-3],
     [5,-2],[4,-4],[3,-5]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
    [[-2,-3],[-3,-2],[-4,-1],[-5,0],[-4,-2],[-3,-3]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
  } else {
    // Down position
    [[-1,-2],[0,-2],[1,-1],[2,-1],[3,0],[4,0],[5,1],
     [4,-1],[3,-2]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
    [[-2,-1],[-3,0],[-4,1],[-5,2],[-4,0],[-3,-1]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
  }
  ctx.fillStyle = '#d4a020';
  // Wing detail
  if (wingUp) {
    [[1,-5],[2,-4],[3,-3]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
  } else {
    [[1,0],[2,-1],[3,-1]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
  }

  // Tail / small tail feathers
  ctx.fillStyle = '#f0c030';
  [[4,1],[5,0],[5,2],[6,1]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));

  // Little hanging bells (apotropaic)
  ctx.fillStyle = '#e0d060';
  [[-1,4],[-2,5],[0,4],[1,5]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));
  ctx.fillStyle = '#a0a000';
  [[-1,5],[0,5]].forEach(([px,py]) => ctx.fillRect((px-1)*S,(py-3)*S,S,S));

  // Eye
  ctx.fillStyle = '#fff';
  ctx.fillRect(1*S, -3*S, S, S);
  ctx.fillStyle = '#000';
  ctx.fillRect(1*S+1, -3*S+1, S-1, S-1);

  ctx.restore();
}

// Draw the face obstacle (pixelated portrait of the AI guy)
function drawFace(x, y, h, fromTop) {
  ctx.save();
  ctx.translate(x, y);
  if (!fromTop) {
    ctx.scale(1, -1);
  }

  const W2 = PIPE_W;
  // Background - blue like the photo
  ctx.fillStyle = '#1a3db5';
  ctx.fillRect(0, 0, W2, h);

  // Scale face to fit width
  const faceW = W2;
  const faceH = Math.max(h, 80);
  const S = Math.floor(faceW / 18);

  // Neck / shirt (white scrubs)
  ctx.fillStyle = '#e8e0d0';
  drawPixels(ctx, S, [
    [6,16],[7,16],[8,16],[9,16],[10,16],[11,16],
    [5,17],[6,17],[7,17],[8,17],[9,17],[10,17],[11,17],[12,17],
    [4,18],[5,18],[6,18],[7,18],[8,18],[9,18],[10,18],[11,18],[12,18],[13,18],
    [4,19],[5,19],[6,19],[7,19],[8,19],[9,19],[10,19],[11,19],[12,19],[13,19],
  ]);
  // Scrubs stain
  ctx.fillStyle = '#c8b898';
  drawPixels(ctx, S, [[8,18],[9,18],[8,19]]);

  // Neck
  ctx.fillStyle = '#c8a888';
  drawPixels(ctx, S, [
    [7,14],[8,14],[9,14],[10,14],
    [7,15],[8,15],[9,15],[10,15],
    [7,16],[8,16],[9,16],[10,16],
  ]);

  // Face skin
  ctx.fillStyle = '#d4aa88';
  drawPixels(ctx, S, [
    [5,6],[6,6],[7,6],[8,6],[9,6],[10,6],[11,6],[12,6],
    [4,7],[5,7],[6,7],[7,7],[8,7],[9,7],[10,7],[11,7],[12,7],[13,7],
    [4,8],[5,8],[6,8],[7,8],[8,8],[9,8],[10,8],[11,8],[12,8],[13,8],
    [4,9],[5,9],[6,9],[7,9],[8,9],[9,9],[10,9],[11,9],[12,9],[13,9],
    [4,10],[5,10],[6,10],[7,10],[8,10],[9,10],[10,10],[11,10],[12,10],[13,10],
    [5,11],[6,11],[7,11],[8,11],[9,11],[10,11],[11,11],[12,11],
    [5,12],[6,12],[7,12],[8,12],[9,12],[10,12],[11,12],
    [6,13],[7,13],[8,13],[9,13],[10,13],[11,13],
  ]);

  // Dark under-eyes (signature look)
  ctx.fillStyle = '#7a6050';
  drawPixels(ctx, S, [
    [5,8],[6,8],[11,8],[12,8],
    [5,9],[6,9],[11,9],[12,9],
  ]);

  // Eyes (hollow, tired)
  ctx.fillStyle = '#c8c8b0';
  drawPixels(ctx, S, [[6,8],[7,8],[10,8],[11,8]]);
  ctx.fillStyle = '#305030';
  drawPixels(ctx, S, [[7,8],[10,8]]);
  ctx.fillStyle = '#000';
  drawPixels(ctx, S, [[7,8],[10,8]]);
  // Eyelid heavy
  ctx.fillStyle = '#9a7860';
  drawPixels(ctx, S, [[6,7],[7,7],[10,7],[11,7]]);

  // Nose
  ctx.fillStyle = '#b89070';
  drawPixels(ctx, S, [
    [8,10],[9,10],[8,11],[10,11],[7,11],[11,11]
  ]);

  // Mustache (the signature stache)
  ctx.fillStyle = '#3a2a1a';
  drawPixels(ctx, S, [
    [6,12],[7,12],[8,12],[9,12],[10,12],[11,12],
    [7,13],[8,13],[9,13],[10,13],
  ]);
  ctx.fillStyle = '#5a3a2a';
  drawPixels(ctx, S, [[6,12],[11,12]]);

  // Hair (dark, messy)
  ctx.fillStyle = '#2a1a0a';
  drawPixels(ctx, S, [
    [5,4],[6,4],[7,4],[8,4],[9,4],[10,4],[11,4],[12,4],
    [4,5],[5,5],[6,5],[7,5],[8,5],[9,5],[10,5],[11,5],[12,5],[13,5],
    [4,6],[5,6],[13,6],
    [3,7],[13,7],[14,7],
  ]);
  // Messy hair bits
  ctx.fillStyle = '#3a2a1a';
  drawPixels(ctx, S, [[6,3],[8,3],[10,3],[9,4],[7,5]]);

  // Lips
  ctx.fillStyle = '#b07060';
  drawPixels(ctx, S, [[8,13],[9,13]]);

  ctx.restore();
}

function drawPixels(ctx, S, coords) {
  coords.forEach(([px, py]) => ctx.fillRect(px * S, py * S, S, S));
}

// ── PIPE (face) management ──
function spawnPipe() {
  const topH = 80 + Math.random() * (H - GAP - 160);
  pipes.push({ x: W, topH, scored: false });
}

function drawPipe(p) {
  // Top face (upside down)
  drawFace(p.x, 0, p.topH, true);
  // Bottom face (right side up)
  drawFace(p.x, p.topH + GAP, H - p.topH - GAP, false);

  // Gap edge lines
  ctx.fillStyle = '#c8a951';
  ctx.fillRect(p.x, p.topH - 2, PIPE_W, 2);
  ctx.fillRect(p.x, p.topH + GAP, PIPE_W, 2);
}

// ── PARTICLES ──
function spawnParticles(x, y, color) {
  for (let i = 0; i < 12; i++) {
    particles.push({
      x, y,
      vx: (Math.random() - 0.5) * 5,
      vy: (Math.random() - 0.5) * 5,
      life: 1, color,
      size: 3 + Math.random() * 4
    });
  }
}

function updateParticles() {
  particles = particles.filter(p => p.life > 0);
  particles.forEach(p => {
    p.x += p.vx; p.y += p.vy; p.vy += 0.2; p.life -= 0.04;
    ctx.globalAlpha = p.life;
    ctx.fillStyle = p.color;
    ctx.fillRect(p.x, p.y, p.size, p.size);
    ctx.globalAlpha = 1;
  });
}

// ── BACKGROUND ──
function drawBG() {
  // Ancient Roman sky gradient
  const grad = ctx.createLinearGradient(0, 0, 0, H);
  grad.addColorStop(0, '#0d1a3a');
  grad.addColorStop(0.5, '#1a2a5a');
  grad.addColorStop(1, '#2a1a3a');
  ctx.fillStyle = grad;
  ctx.fillRect(0, 0, W, H);

  // Stars
  ctx.fillStyle = '#ffffff';
  const stars = [[30,20],[80,40],[150,15],[220,30],[310,10],[370,50],[50,80],[200,70],[350,90],[120,60]];
  stars.forEach(([sx,sy]) => {
    ctx.globalAlpha = 0.4 + 0.3 * Math.sin(frame * 0.05 + sx);
    ctx.fillRect(sx, sy, 2, 2);
  });
  ctx.globalAlpha = 1;
}

// ── HUD ──
function drawHUD() {
  ctx.fillStyle = '#ffd700';
  ctx.font = 'bold 28px Courier New';
  ctx.textAlign = 'center';
  ctx.fillText(score, W / 2, 50);

  ctx.font = '12px Courier New';
  ctx.fillStyle = '#c8a951';
  ctx.fillText('BEST: ' + hiScore, W / 2, 68);
  ctx.textAlign = 'left';
}

function drawStartScreen() {
  ctx.fillStyle = 'rgba(0,0,0,0.6)';
  ctx.fillRect(0, 0, W, H);

  ctx.textAlign = 'center';
  ctx.fillStyle = '#ffd700';
  ctx.font = 'bold 30px Courier New';
  ctx.fillText('FLAPPY FASCINUS', W/2, H/2 - 80);

  ctx.font = '13px Courier New';
  ctx.fillStyle = '#f0d080';
  ctx.fillText('The Ancient Roman Flying Amulet', W/2, H/2 - 50);

  ctx.fillStyle = '#c8a951';
  ctx.fillText('VS.', W/2, H/2 - 20);
  ctx.fillStyle = '#ff9999';
  ctx.fillText('THE FAUSTER', W/2, H/2 + 5);

  ctx.fillStyle = '#ffffff';
  ctx.font = 'bold 14px Courier New';
  const blink = Math.floor(frame / 20) % 2 === 0;
  if (blink) ctx.fillText('[ CLICK or SPACE to Begin ]', W/2, H/2 + 60);

  ctx.font = '10px Courier New';
  ctx.fillStyle = '#888';
  ctx.fillText('(AI-generated face. No real person.)', W/2, H - 20);
  ctx.textAlign = 'left';
}

function drawDeadScreen() {
  ctx.fillStyle = 'rgba(0,0,0,0.7)';
  ctx.fillRect(0, 0, W, H);

  ctx.textAlign = 'center';
  ctx.fillStyle = '#ff4444';
  ctx.font = 'bold 26px Courier New';
  ctx.fillText('SMOTE BY THE FAUSTER', W/2, H/2 - 70);

  ctx.fillStyle = '#ffd700';
  ctx.font = 'bold 20px Courier New';
  ctx.fillText('Score: ' + score, W/2, H/2 - 30);

  if (score === hiScore && score > 0) {
    ctx.fillStyle = '#ffaa00';
    ctx.font = '14px Courier New';
    ctx.fillText('✨ NEW HIGH SCORE! ✨', W/2, H/2);
  }

  ctx.fillStyle = '#c8a951';
  ctx.font = '13px Courier New';
  ctx.fillText('Best: ' + hiScore, W/2, H/2 + 25);

  const blink = Math.floor(frame / 20) % 2 === 0;
  ctx.fillStyle = '#ffffff';
  ctx.font = 'bold 14px Courier New';
  if (blink) ctx.fillText('[ CLICK or SPACE to Retry ]', W/2, H/2 + 65);

  ctx.textAlign = 'left';
}

// ── COLLISION ──
function checkCollision() {
  const bx = bird.x - 18, by = bird.y - 18, bw = 36, bh = 36;
  for (const p of pipes) {
    const px = p.x, pw = PIPE_W;
    if (bx + bw > px && bx < px + pw) {
      if (by < p.topH || by + bh > p.topH + GAP) return true;
    }
  }
  if (bird.y < 10 || bird.y > H - 10) return true;
  return false;
}

// ── GAME LOOP ──
function update() {
  if (gameState !== 'playing') return;

  bird.vy += GRAVITY;
  bird.y += bird.vy;
  bird.rotation = Math.max(-0.4, Math.min(1.2, bird.vy * 0.07));

  // Spawn pipes
  if (frame % PIPE_INTERVAL === 0) spawnPipe();

  // Move pipes
  pipes.forEach(p => p.x -= PIPE_SPEED);
  pipes = pipes.filter(p => p.x + PIPE_W > 0);

  // Score
  pipes.forEach(p => {
    if (!p.scored && p.x + PIPE_W < bird.x) {
      p.scored = true; score++;
      if (score > hiScore) hiScore = score;
      spawnParticles(bird.x, bird.y, '#ffd700');
    }
  });

  if (checkCollision()) {
    spawnParticles(bird.x, bird.y, '#ff4444');
    gameState = 'dead';
  }
}

function draw() {
  ctx.clearRect(0, 0, W, H);
  drawBG();
  pipes.forEach(drawPipe);
  updateParticles();
  drawFascinus(bird.x, bird.y, bird.rotation);
  drawHUD();
  if (gameState === 'start') drawStartScreen();
  if (gameState === 'dead') drawDeadScreen();
}

function loop() {
  update();
  draw();
  frame++;
  requestAnimationFrame(loop);
}

// ── INPUT ──
function flap() {
  if (gameState === 'start') { gameState = 'playing'; return; }
  if (gameState === 'dead') { init(); gameState = 'playing'; return; }
  bird.vy = FLAP;
  spawnParticles(bird.x - 10, bird.y, '#f0c030');
}

canvas.addEventListener('click', flap);
document.addEventListener('keydown', e => { if (e.code === 'Space') { e.preventDefault(); flap(); } });

loop();
</script>
</body>
</html>
